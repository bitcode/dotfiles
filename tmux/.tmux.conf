set-window-option -g mode-keys vi
set -s escape-time 20
set -sg repeat-time 600
set -s focus-events on
set-window-option -g aggressive-resize on
set-option -g default-terminal "screen-256color"
# Change cursor shape in tmux based on vi mode
set-option -g -q mouse on
set-window-option -g mode-style 'fg=default,bg=default'
set-window-option -g window-status-current-style 'fg=default,bg=default'
set-option -g status-style 'fg=default,bg=default'

# Normal mode
set-option -g status-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Insert mode
set-option -g status-keys emacs

# Pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Pane resizing
bind -r H resize-pane -L 2
bind -r J resize-pane -D 2
bind -r K resize-pane -U 2
bind -r L resize-pane -R 2

# Plugins
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @prefix_highlight_output_prefix '< '
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'dominikduda/tmux_mode_indicator'

# Status bar
setw -g window-status-format "#{pane_current_path}"
set -g base-index 1
set -g pane-base-index 1
set-option -g status "on"
set-option -g status-style bg=colour237,fg=colour223
set-window-option -g window-status-style bg=colour214,fg=colour237
set-window-option -g window-status-activity-style bg=colour237,fg=colour248
set-window-option -g window-status-current-style bg=red,fg=colour237
set-option -g pane-active-border-style fg=colour214
set-option -g pane-border-style fg=colour239
set-option -g message-style bg=colour239,fg=colour223
set-option -g message-command-style bg=colour239,fg=colour223

# source .tmux.conf with prefix r
bind r source-file ~/.tmux.conf

# Pane number display
set-option -g display-panes-active-colour colour1
set-option -g display-panes-colour colour237

# Bell
set-window-option -g window-status-bell-style bg=colour167,fg=colour235

# don't exit tmux when killing session 
bind-key x kill-pane # skip "kill-pane 1? (y/n)" prompt
set -g detach-on-destroy off  # don't exit from tmux when closing a session

# neovim fix
set-option -g status-left "\
#[fg=colour7, bg=colour241]#{?client_prefix,#[bg=colour167],} ❐ #S \
#[fg=colour241, bg=colour237]#{?client_prefix,#[fg=colour167],} \
#[fg=colour1] "

set-option -g status-right "\
#[fg=colour246, bg=colour237]    \
#[fg=colour214, bg=colour237] \
#[fg=colour237, bg=colour214]  #(~/dotfiles/scripts/vpn.sh) \
#[fg=colour223, bg=colour237]  #(~/dotfiles/scripts/lan_ip.sh) \
#[fg=colour214, bg=colour237]  #(~/dotfiles/scripts/disk_usage.sh) \
#[fg=colour237, bg=colour214] #(~/dotfiles/scripts/tmux_session_info.sh) "

set-window-option -g window-status-current-format "\
#[fg=colour237, bg=colour214]\
#[fg=colour239, bg=colour214] #I* \
#[fg=colour239, bg=colour214, bold] #W \
#[fg=colour214, bg=colour237]"

set-window-option -g window-status-format "\
#[fg=colour237,bg=colour239,noitalics]\
#[fg=colour223,bg=colour239] #I \
#[fg=colour223, bg=colour239] #W \
#[fg=colour239, bg=colour237]"

# Set the history limit so we get lots of scrollback.
setw -g history-limit 500000
run -b '~/.tmux/plugins/tpm/tpm'

# Load only on default shell (alacritty)
set -g default-command "${SHELL}"
